---
id: workflow.tasklifecycle-long.phase-1-research
description: Phase 1 of the task lifecycle. Exhaustive technical research of needs and alternatives. Requires explicit developer approval.
owner: researcher-agent
version: 1.0.0
severity: PERMANENT
trigger:
  commands: ["phase1", "phase-1", "research"]
blocking: true
---

# WORKFLOW: tasklifecycle.phase-1-research

## Input (REQUIRED)
- The current task exists:
  - `.agent/artifacts/<taskId>-<taskTitle>/task.md`
- The `task.md` **MUST** reflect:
  - `task.phase.current == aliases.tasklifecycle-long.phases.phase_1.id`
- The `task.md` **MUST** include:
  - description
  - objective
  - defined acceptance criteria

> [!IMPORTANT]
> **Active constitution (MANDATORY)**:
> - Load `constitution.clean_code` before starting
> - Load `constitution.agents_behavior` (section 7: Gates, section 8: Constitution)

## Output (REQUIRED)
- Research report (mandatory, generated by researcher-agent):
  - `.agent/artifacts/<taskId>-<taskTitle>/researcher/research.md`
- State update in the current task:
  - `.agent/artifacts/<taskId>-<taskTitle>/task.md`

## Objective (ONLY)
- Investigate technical needs detected for the task.
- Explore alternatives and relevant APIs.
- Document compatibility and risks.
- Deliver a rigorous and verifiable report for the architect-agent.

> This phase **DOES NOT implement code**.
> This phase **REQUIRES explicit developer approval**.

> [!CAUTION]
> **PERMANENT RULE**: Research DOCUMENTS, it does NOT analyze.
> The researcher-agent gathers information from official sources.
> **PROHIBITED**: proposing solutions, evaluating trade-offs, recommending alternatives.
> Analysis belongs to Phase 2.

## Template (MANDATORY)
- The report **MUST** be created using the template:
  - `templates.research`
- If the template does not exist or cannot be loaded ‚Üí **FAIL**.

---

## Mandatory Steps
0. Activate `researcher-agent` and use the mandatory prefix in every message.

1. Verify inputs (architect-agent)
   - `task.md` exists
   - `task.phase.current == aliases.tasklifecycle-long.phases.phase_1.id`
   - `task.md` contains acceptance criteria
   - If it fails ‚Üí go to **Step 8 (FAIL)**.

2. Load research template (architect-agent)
   - Load `templates.research`
   - If it does not exist or cannot be read ‚Üí go to **Step 8 (FAIL)**.

3. **Delegate to researcher-agent (MANDATORY)**
   > ‚ö†Ô∏è **PERMANENT RULE**: The `architect-agent` **CANNOT** create the research report.
   > The `researcher-agent` is the **only authorized agent** to create `research.md`.
   
   The `architect-agent` **MUST**:
   a) Activate the `researcher-agent` with the task context:
      - Task description and objective
      - Acceptance criteria
      - Template to use (`templates.research`)
   b) Wait for the `researcher-agent` to complete the report
   c) Verify that the report exists and follows the template
   
   **Mandatory researcher-agent prefix**: `üî¨ **researcher-agent**:`
   
   The `researcher-agent` **MUST**:
   - Create the directory: `.agent/artifacts/<taskId>-<taskTitle>/researcher/`
   - Create the report: `.agent/artifacts/<taskId>-<taskTitle>/researcher/research.md`
   - Strictly follow the `templates.research` template
   - Cover all mandatory points:
     - technical alternatives and relevant APIs
     - multi-browser compatibility
     - risks and trade-offs
     - AI-first recommendations
     - official or reputable sources
   - Return control to the `architect-agent` upon completion


4. Request developer approval (MANDATORY, via console)
   - The developer **MUST** issue a binary decision:
     - **SI** ‚Üí approved
     - **NO** ‚Üí rejected
   - Record the decision in `research.md` with the format:
     ```yaml
     approval:
       developer:
         decision: SI | NO
         date: <ISO-8601>
         comments: <optional>
     ```
   - If `decision != SI` ‚Üí go to **Step 8 (FAIL)**.

5. PASS
   - Report that Phase 1 is correctly completed.
   - The `architect-agent` **MUST explicitly perform** the following actions:
     - Mark Phase 1 as completed in `task.md`.
     - Set `task.lifecycle.phases.phase-1-research.completed = true`.
     - Set `task.lifecycle.phases.phase-1-research.validated_at = <ISO-8601>`.
     - Update `task.phase.updated_at = <ISO-8601>`.
     - Update the state:
       - `task.phase.current = aliases.tasklifecycle-long.phases.phase_2.id`
   - This update is **NOT automatic** and **CANNOT be inferred**.
   - Until this change is reflected in `task.md`, **Phase 2 cannot be started**.
   - Indicate paths:
     - `research.md`
     - `task.md` updated

---

## FAIL (MANDATORY)

8. Declare Phase 1 as **NOT completed**
   - Indicate exactly what failed:
     - non-existent task
     - incorrect phase
     - non-existent template
     - failure creating `research.md`
     - developer approval = NO or missing
   - Request the minimum action to resolve
   - Terminate blocked: do not advance phase.

---

## Gate (REQUIRED)

Requirements (all mandatory):
1. `.agent/artifacts/<taskId>-<taskTitle>/researcher/research.md` exists.
2. The report follows the `templates.research` template structure.
3. The `research.md` starts with the `researcher-agent` prefix.
4. The report **MUST** have been created by the `researcher-agent`, **NOT** by the `architect-agent`.
   > ‚ö†Ô∏è If the report was created by another agent ‚Üí **Gate FAIL**.
5. Explicit developer approval exists:
   - `approval.developer.decision == SI`
6. The research is deep, detailed, and based on official or reputable sources.
7. The report **DOES NOT contain** analysis, recommendations, or evaluations.
8. `task.md` reflects:
   - Phase 1 completed
   - `task.phase.current == aliases.tasklifecycle-long.phases.phase_2.id`
   - `task.lifecycle.phases.phase-1-research.completed == true`
   - `task.lifecycle.phases.phase-1-research.validated_at` not null
   - `task.phase.updated_at` not null

If Gate FAIL:
- Execute **Step 8 (FAIL)**.
