# Roadmap Backlog - Advanced Agentic Workflow

## ðŸŒ Global Status
| Domain | Status | Completed | Total |
|---|---|---|---|
| **D1: Settings & OAuth** | ðŸ—ï¸ Architecture | 6 | 8 |
| **D2: UI (Chat/Workflows)** | ðŸ—ï¸ In Progress | 7 | 12 |
| **D3: Backend (Agents)** | ðŸ—ï¸ In Progress | 4 | 8 |
| **D4: Runtime & Execution** | ðŸ—ï¸ Concept | 0 | 2 |
| **D7: Release/CI-CD** | âœ… Stable | 3 | 3 |
| **D8: E2E Testing** | âœ… Stable | 4 | 4 |

**Total**: 24/37 tasks completed

## ðŸŽ¯ Priority High - Critical Path
- [x] **T017**: D1 - OAuth Authentication Provider (vscode.authentication)
- [x] **T018**: D1 - Model Registry UI (API Key + OAuth Tokens)
- [x] **T010**: D3 - Chat Session Endpoint
- [x] **T019**: D3 - Agent Factory & Role-Model Binding âœ…
- [x] **T039**: D3 - Agent Delegation (Inter-Agent Task Routing) âœ…
- [ ] **T024**: D2 - Workflow Viewer (Load & Display) ðŸ”¥ **NEXT**
- [ ] **T043**: D3 - Async Delegation & Multi-Stream
- [ ] **T032**: D4 - Runtime Server (File I/O & Sandbox)
- [ ] **T020**: D2 - Chat Filters (Agent/Thread)

---

## ðŸ“… Backlog by Domain

### D1: Settings & Configuration (OAuth)
> Focus: Secure token management and Model Registry.
- [x] **T017**: OAuth Provider Implementation
  - Implement `AuthenticationProvider` for Google OAuth + PKCE. âœ…
  - Integration with `vscode.authentication`. âœ…
  - âš ï¸ OpenAI does NOT support third-party OAuth (API keys only).
  - OAuth timeout fix: 10s â†’ 120s for browser login flows.
- [x] **T018**: Model Registry UI
  - CRUD for LLM Models (Name, Provider, AuthType). âœ…
  - Secure storage of API Keys vs OAuth Tokens. âœ…
- [ ] **T021**: Settings Migration
  - Migrate current `settings.json` to new Registry format.
- [ ] **T022**: Profile Management
  - Allow switching between "Work" (Codex) and "Research" (Claude) profiles.
- [x] **T023**: Settings Validation
  - Verify API Keys/Tokens on save. âœ… (Test Connection for API key + OAuth)
- [x] **T040**: Disabled Roles Configuration
  - Register `disabledRoles` in package.json. âœ…
  - Chat dropdown filters out disabled agents. âœ…
- [x] **T034**: Default Model per Task Type
  - Role-Model binding via Settings Role Binding section. âœ…
  - Each agent role can be assigned a specific model. âœ…
  - Model description shown on selection to aid decision. âœ…
- [ ] **T035**: Import/Export Configuration
  - Export model registry to JSON/YAML. Import from file.
- [x] **T036**: Advanced Validation
  - Model capability detection (vision, tools, code, streaming). âœ…
  - Capability toggles visible per agent in Role Binding. âœ…
  - `detectCapabilities()` auto-detects from model name. âœ…

### D2: UI & User Experience (Advanced)
> Focus: Visual Workflows and Enhanced Chat.
- [x] **T041**: Agent Dropdown UX
  - Dropdown opens upward (above input). âœ…
  - All agents visible regardless of model assignment. âœ…
  - `index.md` excluded from role listing. âœ…
  - Max-height with scroll for many agents. âœ…
- [ ] **T024**: Workflow Viewer (Litegraph)
  - Integrate **Litegraph.js** into a Lit Component.
  - Read-only view of `.agent/workflows/*.md` (parsed to graph).
- [ ] **T025**: Workflow Editor (Litegraph)
  - Drag & Drop interface for creating workflows.
  - Serialize to JSON/YAML.
- [ ] **T020**: Chat Filters
  - Filter messages by specific Agent (e.g., "Show only Architect").
  - Filter by Thread/Task.
- [ ] **T026**: Task Timeline
  - Visualize Agent execution history using **vis-timeline**.
  - Interactive zoom/pan.
- [ ] **T027**: Agent Status Widget
  - Real-time status in VS Code Status Bar.
- [ ] **T028**: Theme Synchronization
  - Ensure all Lit components (Graph/Timeline) match VS Code Theme.
- [x] **T037**: App Version & Footer Refactor
  - Centralize version logic in App class. âœ…
  - Move footer to AppView template. âœ…
- [x] **T044**: History Tab UX
  - Session list loads reactively via AppView state. âœ…
  - Session persistence via globalState (survives restarts). âœ…
  - Double-click delete with 3s auto-cancel (matches Settings). âœ…
  - Header style matches Settings (header-actions pattern). âœ…
- [x] **T045**: Skeleton Loading System
  - 1s skeleton overlay on every tab transition. âœ…
  - Views always mounted in DOM (no removal/re-add). âœ…
  - AppView @state() with accessor for proper Lit reactivity. âœ…
- [x] **T046**: Model Descriptions in Settings
  - getModelDescription() for 20+ known models. âœ…
  - Shown in Role Binding card on model selection. âœ…
  - Fade-in animation, italic styling. âœ…
- [x] **T047**: Chat Agent Bar Layout
  - Capabilities and Sandbox toggle on second row. âœ…
  - Agent dropdown on first row, labels below. âœ…

### D3: Backend & Agent Orchestration
> Focus: Dynamic Agent Instantiation & Multi-Agent Collaboration.
- [x] **T010**: Chat Session Endpoint
  - Ensure `ChatBackendClient` targets correct `/sessions` endpoint. âœ…
  - Functional chat flow restored. âœ…
- [x] **T019**: Agent Factory & Persona Injection
  - Role-Model binding via Settings. âœ…
  - `LLMFactory.createAgent()` resolves provider + model dynamically. âœ…
  - Full role `.md` content injected as system prompt instructions. âœ…
  - Agent personality persists throughout conversation. âœ…
  - Attachment context appended to LLM input. âœ…
- [x] **T042**: Agent Selection & Context
  - Chat dropdown shows all workspace roles. âœ…
  - Selected agent's role sent to sidecar. âœ…
  - Attached files included in LLM context. âœ…
  - System loading messages hidden (errors only). âœ…
- [x] **T039**: Agent Delegation (Inter-Agent Task Routing) âœ…
  - `delegateTask` tool for coordinator agents (architect). âœ…
  - Sub-agent invocation within a single chat session. âœ…
  - Delegation result returned as tool_result to coordinator. âœ…
  - Visual indicator in chat ("ðŸ”€ Delegated to QA â†’ ..."). âœ…
  - Recursion guard (max depth, no self-delegation). âœ…
  - Per-agent pastel colors in chat. âœ…
  - Sub-agents instructed to ask developer questions. âœ…
- [ ] **T043**: Async Delegation & Multi-Stream ðŸ”¥
  - Async delegation: sub-agent runs in background, returns task ID.
  - Chat multi-stream: support concurrent SSE streams.
  - Continue chatting with architect while delegation runs.
  - Polling/notification when sub-agent completes.
  - Real-time intermediate streaming of sub-agent output.
- [ ] **T029**: Role Definition Schema
  - Enhance `roles.yaml` to support forced model capabilities (e.g., "Requires Vision").
- [ ] **T030**: Agent Lifecycle Events
  - Emit events (Start/Think/Tool/End) for the Timeline UI.
- [ ] **T031**: Context Windows Management
  - Dynamic context pruning based on Agent-Model limits.

### D4: Runtime & Execution Engine
> Focus: Flow Control and Safe Action Execution.
- [ ] **T032**: Runtime Server (Action Runner)
  - Dedicated server/process to execute Agent actions (File Read/Write, Command Exec).
  - Sandboxing and permission control (Allow/Deny prompts).
- [ ] **T033**: Flow Engine
  - Interpreter to execute Litegraph workflows (JSON).
  - Orchestrates data flow between nodes and calls Agent Actions.

### D7 & D8 (Maintenance)
- [x] CI/CD Pipelines (Done)
- [x] E2E Base Suite (Done)
- [x] **T038**: Fix CI Build Errors
  - Resolved TypeScript errors in CI. âœ…

---

## ðŸš€ Next Suggested Steps
1.  **T024 (Workflow Viewer)**: Load and display `.agent/workflows/*.md` in UI. ðŸ”¥
2.  **T043 (Async Delegation)**: Multi-stream + continue chatting during delegation.
3.  **T020 (Chat Filters)**: Quick win for UI usability.

**Last Updated**: 2026-02-20 by architect-agent (priorities reordered: T024 before T043)

